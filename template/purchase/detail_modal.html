<!-- BOTONES -->
<div class="modal-header bg-primary text-white align-items-center justify-content-between">
  <h5 class="modal-title">
    ğŸ§¾ Compra NÂ° {{ purchase.id }} â€” {{ purchase.supplier.name }}
  </h5>
  <div class="d-flex gap-2">
    <a href="{% url 'commerce:purchase_update' purchase.id %}" class="btn btn-warning btn-sm">âœï¸ Editar</a>
    <button type="button" class="btn btn-outline-danger btn-sm" id="btnDelete" data-id="{{ purchase.id }}">ğŸ—‘ï¸ Eliminar</button>
    {% if purchase.active %}
      <button type="button" class="btn btn-danger btn-sm" id="btnAnnul" data-id="{{ purchase.id }}">â›” Anular</button>
    {% endif %}
    </div>
    <button type="button" class="btn btn-secondary btn-sm" id="btnPrintPDF" data-id="{{ purchase.id }}">ğŸ–¨ï¸ Imprimir PDF</button>
    <button type="button" class="btn btn-light btn-sm" data-bs-dismiss="modal">âœ–ï¸ Cerrar</button>
  </div>
</div>
<div class="modal-body">
  <!-- CABECERA -->
  <div class="row mb-4 border-bottom pb-2">
    <div class="col-md-6">
      <p><strong>Proveedor:</strong> {{ purchase.supplier.name }}</p>
      <p><strong>RUC:</strong> {{ purchase.supplier.ruc }}</p>
      <p><strong>DirecciÃ³n:</strong> {{ purchase.supplier.address }}</p>
    </div>
    <div class="col-md-6 text-end">
      <p><strong>Fecha:</strong> {{ purchase.issue_date|date:"d/m/Y H:i" }}</p>
      <p><strong>NÂ° Documento:</strong> {{ purchase.num_document }}</p>
      <p><strong>Estado:</strong>
        {% if purchase.active %}
          <span class="badge bg-success">Activo</span>
        {% else %}
          <span class="badge bg-danger">Inactivo</span>
        {% endif %}
      </p>
    </div>
  </div>
  <!-- DETALLE DE PRODUCTOS -->
  <div class="table-responsive">
    <table class="table table-bordered table-hover align-middle">
      <thead class="table-light">
        <tr class="text-center">
          <th>CÃ³digo</th>
          <th>DescripciÃ³n</th>
          <th>Cantidad</th>
          <th>Costo</th>
          <th>IVA</th>
          <th>Subtotal</th>
        </tr>
      </thead>
      <tbody>
        {% for det in details %}
        <tr>
          <td class="text-center">{{ det.product.id }}</td>
          <td>{{ det.product.description }}</td>
          <td class="text-center">{{ det.quantify|floatformat:2 }}</td>
          <td class="text-end">${{ det.cost|floatformat:2 }}</td>
          <td class="text-end">${{ det.iva|floatformat:2 }}</td>
          <td class="text-end fw-semibold">${{ det.subtotal|floatformat:2 }}</td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="6" class="text-center text-muted py-3">No hay productos registrados.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  <!-- TOTALES -->
  <div class="row justify-content-end">
    <div class="col-md-4">
      <ul class="list-group">
        <li class="list-group-item d-flex justify-content-between align-items-center">
          <span>Subtotal</span>
          <span class="fw-bold">${{ purchase.subtotal|floatformat:2 }}</span>
        </li>
        <li class="list-group-item d-flex justify-content-between align-items-center">
          <span>IVA</span>
          <span class="fw-bold">${{ purchase.iva|floatformat:2 }}</span>
        </li>
        <li class="list-group-item d-flex justify-content-between align-items-center bg-primary text-white">
          <span class="fw-bold">Total</span>
          <span class="fw-bold">${{ purchase.total|floatformat:2 }}</span>
        </li>
      </ul>
    </div>
  </div>
</div>
